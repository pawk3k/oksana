{"ast":null,"code":"(function (global) {\n  //\n  // Check for native Promise and it has correct interface\n  //\n  var NativePromise = global['Promise'];\n\n  var nativePromiseSupported = NativePromise && // Some of these methods are missing from\n  // Firefox/Chrome experimental implementations\n  'resolve' in NativePromise && 'reject' in NativePromise && 'all' in NativePromise && 'race' in NativePromise && // Older version of the spec had a resolver object\n  // as the arg rather than a function\n  function () {\n    var resolve;\n    new NativePromise(function (r) {\n      resolve = r;\n    });\n    return typeof resolve === 'function';\n  }(); //\n  // export if necessary\n  //\n\n\n  if (typeof exports !== 'undefined' && exports) {\n    // node.js\n    exports.Promise = nativePromiseSupported ? NativePromise : Promise;\n    exports.Polyfill = Promise;\n  } else {\n    // AMD\n    if (typeof define == 'function' && define.amd) {\n      define(function () {\n        return nativePromiseSupported ? NativePromise : Promise;\n      });\n    } else {\n      // in browser add to global\n      if (!nativePromiseSupported) global['Promise'] = Promise;\n    }\n  } //\n  // Polyfill\n  //\n\n\n  var PENDING = 'pending';\n  var SEALED = 'sealed';\n  var FULFILLED = 'fulfilled';\n  var REJECTED = 'rejected';\n\n  var NOOP = function () {};\n\n  function isArray(value) {\n    return Object.prototype.toString.call(value) === '[object Array]';\n  } // async calls\n\n\n  var asyncSetTimer = typeof setImmediate !== 'undefined' ? setImmediate : setTimeout;\n  var asyncQueue = [];\n  var asyncTimer;\n\n  function asyncFlush() {\n    // run promise callbacks\n    for (var i = 0; i < asyncQueue.length; i++) asyncQueue[i][0](asyncQueue[i][1]); // reset async asyncQueue\n\n\n    asyncQueue = [];\n    asyncTimer = false;\n  }\n\n  function asyncCall(callback, arg) {\n    asyncQueue.push([callback, arg]);\n\n    if (!asyncTimer) {\n      asyncTimer = true;\n      asyncSetTimer(asyncFlush, 0);\n    }\n  }\n\n  function invokeResolver(resolver, promise) {\n    function resolvePromise(value) {\n      resolve(promise, value);\n    }\n\n    function rejectPromise(reason) {\n      reject(promise, reason);\n    }\n\n    try {\n      resolver(resolvePromise, rejectPromise);\n    } catch (e) {\n      rejectPromise(e);\n    }\n  }\n\n  function invokeCallback(subscriber) {\n    var owner = subscriber.owner;\n    var settled = owner.state_;\n    var value = owner.data_;\n    var callback = subscriber[settled];\n    var promise = subscriber.then;\n\n    if (typeof callback === 'function') {\n      settled = FULFILLED;\n\n      try {\n        value = callback(value);\n      } catch (e) {\n        reject(promise, e);\n      }\n    }\n\n    if (!handleThenable(promise, value)) {\n      if (settled === FULFILLED) resolve(promise, value);\n      if (settled === REJECTED) reject(promise, value);\n    }\n  }\n\n  function handleThenable(promise, value) {\n    var resolved;\n\n    try {\n      if (promise === value) throw new TypeError('A promises callback cannot return that same promise.');\n\n      if (value && (typeof value === 'function' || typeof value === 'object')) {\n        var then = value.then; // then should be retrived only once\n\n        if (typeof then === 'function') {\n          then.call(value, function (val) {\n            if (!resolved) {\n              resolved = true;\n              if (value !== val) resolve(promise, val);else fulfill(promise, val);\n            }\n          }, function (reason) {\n            if (!resolved) {\n              resolved = true;\n              reject(promise, reason);\n            }\n          });\n          return true;\n        }\n      }\n    } catch (e) {\n      if (!resolved) reject(promise, e);\n      return true;\n    }\n\n    return false;\n  }\n\n  function resolve(promise, value) {\n    if (promise === value || !handleThenable(promise, value)) fulfill(promise, value);\n  }\n\n  function fulfill(promise, value) {\n    if (promise.state_ === PENDING) {\n      promise.state_ = SEALED;\n      promise.data_ = value;\n      asyncCall(publishFulfillment, promise);\n    }\n  }\n\n  function reject(promise, reason) {\n    if (promise.state_ === PENDING) {\n      promise.state_ = SEALED;\n      promise.data_ = reason;\n      asyncCall(publishRejection, promise);\n    }\n  }\n\n  function publish(promise) {\n    var callbacks = promise.then_;\n    promise.then_ = undefined;\n\n    for (var i = 0; i < callbacks.length; i++) {\n      invokeCallback(callbacks[i]);\n    }\n  }\n\n  function publishFulfillment(promise) {\n    promise.state_ = FULFILLED;\n    publish(promise);\n  }\n\n  function publishRejection(promise) {\n    promise.state_ = REJECTED;\n    publish(promise);\n  }\n  /**\n  * @class\n  */\n\n\n  function Promise(resolver) {\n    if (typeof resolver !== 'function') throw new TypeError('Promise constructor takes a function argument');\n    if (this instanceof Promise === false) throw new TypeError('Failed to construct \\'Promise\\': Please use the \\'new\\' operator, this object constructor cannot be called as a function.');\n    this.then_ = [];\n    invokeResolver(resolver, this);\n  }\n\n  Promise.prototype = {\n    constructor: Promise,\n    state_: PENDING,\n    then_: null,\n    data_: undefined,\n    then: function (onFulfillment, onRejection) {\n      var subscriber = {\n        owner: this,\n        then: new this.constructor(NOOP),\n        fulfilled: onFulfillment,\n        rejected: onRejection\n      };\n\n      if (this.state_ === FULFILLED || this.state_ === REJECTED) {\n        // already resolved, call callback async\n        asyncCall(invokeCallback, subscriber);\n      } else {\n        // subscribe\n        this.then_.push(subscriber);\n      }\n\n      return subscriber.then;\n    },\n    'catch': function (onRejection) {\n      return this.then(null, onRejection);\n    }\n  };\n\n  Promise.all = function (promises) {\n    var Class = this;\n    if (!isArray(promises)) throw new TypeError('You must pass an array to Promise.all().');\n    return new Class(function (resolve, reject) {\n      var results = [];\n      var remaining = 0;\n\n      function resolver(index) {\n        remaining++;\n        return function (value) {\n          results[index] = value;\n          if (! --remaining) resolve(results);\n        };\n      }\n\n      for (var i = 0, promise; i < promises.length; i++) {\n        promise = promises[i];\n        if (promise && typeof promise.then === 'function') promise.then(resolver(i), reject);else results[i] = promise;\n      }\n\n      if (!remaining) resolve(results);\n    });\n  };\n\n  Promise.race = function (promises) {\n    var Class = this;\n    if (!isArray(promises)) throw new TypeError('You must pass an array to Promise.race().');\n    return new Class(function (resolve, reject) {\n      for (var i = 0, promise; i < promises.length; i++) {\n        promise = promises[i];\n        if (promise && typeof promise.then === 'function') promise.then(resolve, reject);else resolve(promise);\n      }\n    });\n  };\n\n  Promise.resolve = function (value) {\n    var Class = this;\n    if (value && typeof value === 'object' && value.constructor === Class) return value;\n    return new Class(function (resolve) {\n      resolve(value);\n    });\n  };\n\n  Promise.reject = function (reason) {\n    var Class = this;\n    return new Class(function (resolve, reject) {\n      reject(reason);\n    });\n  };\n})(typeof window != 'undefined' ? window : typeof global != 'undefined' ? global : typeof self != 'undefined' ? self : this);","map":{"version":3,"sources":["/home/kraven/Documents/oksana/node_modules/es6-promise-polyfill/promise.js"],"names":["global","NativePromise","nativePromiseSupported","resolve","r","exports","Promise","Polyfill","define","amd","PENDING","SEALED","FULFILLED","REJECTED","NOOP","isArray","value","Object","prototype","toString","call","asyncSetTimer","setImmediate","setTimeout","asyncQueue","asyncTimer","asyncFlush","i","length","asyncCall","callback","arg","push","invokeResolver","resolver","promise","resolvePromise","rejectPromise","reason","reject","e","invokeCallback","subscriber","owner","settled","state_","data_","then","handleThenable","resolved","TypeError","val","fulfill","publishFulfillment","publishRejection","publish","callbacks","then_","undefined","constructor","onFulfillment","onRejection","fulfilled","rejected","all","promises","Class","results","remaining","index","race","window","self"],"mappings":"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","sourcesContent":["(function(global){\n\n//\n// Check for native Promise and it has correct interface\n//\n\nvar NativePromise = global['Promise'];\nvar nativePromiseSupported =\n  NativePromise &&\n  // Some of these methods are missing from\n  // Firefox/Chrome experimental implementations\n  'resolve' in NativePromise &&\n  'reject' in NativePromise &&\n  'all' in NativePromise &&\n  'race' in NativePromise &&\n  // Older version of the spec had a resolver object\n  // as the arg rather than a function\n  (function(){\n    var resolve;\n    new NativePromise(function(r){ resolve = r; });\n    return typeof resolve === 'function';\n  })();\n\n\n//\n// export if necessary\n//\n\nif (typeof exports !== 'undefined' && exports)\n{\n  // node.js\n  exports.Promise = nativePromiseSupported ? NativePromise : Promise;\n  exports.Polyfill = Promise;\n}\nelse\n{\n  // AMD\n  if (typeof define == 'function' && define.amd)\n  {\n    define(function(){\n      return nativePromiseSupported ? NativePromise : Promise;\n    });\n  }\n  else\n  {\n    // in browser add to global\n    if (!nativePromiseSupported)\n      global['Promise'] = Promise;\n  }\n}\n\n\n//\n// Polyfill\n//\n\nvar PENDING = 'pending';\nvar SEALED = 'sealed';\nvar FULFILLED = 'fulfilled';\nvar REJECTED = 'rejected';\nvar NOOP = function(){};\n\nfunction isArray(value) {\n  return Object.prototype.toString.call(value) === '[object Array]';\n}\n\n// async calls\nvar asyncSetTimer = typeof setImmediate !== 'undefined' ? setImmediate : setTimeout;\nvar asyncQueue = [];\nvar asyncTimer;\n\nfunction asyncFlush(){\n  // run promise callbacks\n  for (var i = 0; i < asyncQueue.length; i++)\n    asyncQueue[i][0](asyncQueue[i][1]);\n\n  // reset async asyncQueue\n  asyncQueue = [];\n  asyncTimer = false;\n}\n\nfunction asyncCall(callback, arg){\n  asyncQueue.push([callback, arg]);\n\n  if (!asyncTimer)\n  {\n    asyncTimer = true;\n    asyncSetTimer(asyncFlush, 0);\n  }\n}\n\n\nfunction invokeResolver(resolver, promise) {\n  function resolvePromise(value) {\n    resolve(promise, value);\n  }\n\n  function rejectPromise(reason) {\n    reject(promise, reason);\n  }\n\n  try {\n    resolver(resolvePromise, rejectPromise);\n  } catch(e) {\n    rejectPromise(e);\n  }\n}\n\nfunction invokeCallback(subscriber){\n  var owner = subscriber.owner;\n  var settled = owner.state_;\n  var value = owner.data_;  \n  var callback = subscriber[settled];\n  var promise = subscriber.then;\n\n  if (typeof callback === 'function')\n  {\n    settled = FULFILLED;\n    try {\n      value = callback(value);\n    } catch(e) {\n      reject(promise, e);\n    }\n  }\n\n  if (!handleThenable(promise, value))\n  {\n    if (settled === FULFILLED)\n      resolve(promise, value);\n\n    if (settled === REJECTED)\n      reject(promise, value);\n  }\n}\n\nfunction handleThenable(promise, value) {\n  var resolved;\n\n  try {\n    if (promise === value)\n      throw new TypeError('A promises callback cannot return that same promise.');\n\n    if (value && (typeof value === 'function' || typeof value === 'object'))\n    {\n      var then = value.then;  // then should be retrived only once\n\n      if (typeof then === 'function')\n      {\n        then.call(value, function(val){\n          if (!resolved)\n          {\n            resolved = true;\n\n            if (value !== val)\n              resolve(promise, val);\n            else\n              fulfill(promise, val);\n          }\n        }, function(reason){\n          if (!resolved)\n          {\n            resolved = true;\n\n            reject(promise, reason);\n          }\n        });\n\n        return true;\n      }\n    }\n  } catch (e) {\n    if (!resolved)\n      reject(promise, e);\n\n    return true;\n  }\n\n  return false;\n}\n\nfunction resolve(promise, value){\n  if (promise === value || !handleThenable(promise, value))\n    fulfill(promise, value);\n}\n\nfunction fulfill(promise, value){\n  if (promise.state_ === PENDING)\n  {\n    promise.state_ = SEALED;\n    promise.data_ = value;\n\n    asyncCall(publishFulfillment, promise);\n  }\n}\n\nfunction reject(promise, reason){\n  if (promise.state_ === PENDING)\n  {\n    promise.state_ = SEALED;\n    promise.data_ = reason;\n\n    asyncCall(publishRejection, promise);\n  }\n}\n\nfunction publish(promise) {\n  var callbacks = promise.then_;\n  promise.then_ = undefined;\n\n  for (var i = 0; i < callbacks.length; i++) {\n    invokeCallback(callbacks[i]);\n  }\n}\n\nfunction publishFulfillment(promise){\n  promise.state_ = FULFILLED;\n  publish(promise);\n}\n\nfunction publishRejection(promise){\n  promise.state_ = REJECTED;\n  publish(promise);\n}\n\n/**\n* @class\n*/\nfunction Promise(resolver){\n  if (typeof resolver !== 'function')\n    throw new TypeError('Promise constructor takes a function argument');\n\n  if (this instanceof Promise === false)\n    throw new TypeError('Failed to construct \\'Promise\\': Please use the \\'new\\' operator, this object constructor cannot be called as a function.');\n\n  this.then_ = [];\n\n  invokeResolver(resolver, this);\n}\n\nPromise.prototype = {\n  constructor: Promise,\n\n  state_: PENDING,\n  then_: null,\n  data_: undefined,\n\n  then: function(onFulfillment, onRejection){\n    var subscriber = {\n      owner: this,\n      then: new this.constructor(NOOP),\n      fulfilled: onFulfillment,\n      rejected: onRejection\n    };\n\n    if (this.state_ === FULFILLED || this.state_ === REJECTED)\n    {\n      // already resolved, call callback async\n      asyncCall(invokeCallback, subscriber);\n    }\n    else\n    {\n      // subscribe\n      this.then_.push(subscriber);\n    }\n\n    return subscriber.then;\n  },\n\n  'catch': function(onRejection) {\n    return this.then(null, onRejection);\n  }\n};\n\nPromise.all = function(promises){\n  var Class = this;\n\n  if (!isArray(promises))\n    throw new TypeError('You must pass an array to Promise.all().');\n\n  return new Class(function(resolve, reject){\n    var results = [];\n    var remaining = 0;\n\n    function resolver(index){\n      remaining++;\n      return function(value){\n        results[index] = value;\n        if (!--remaining)\n          resolve(results);\n      };\n    }\n\n    for (var i = 0, promise; i < promises.length; i++)\n    {\n      promise = promises[i];\n\n      if (promise && typeof promise.then === 'function')\n        promise.then(resolver(i), reject);\n      else\n        results[i] = promise;\n    }\n\n    if (!remaining)\n      resolve(results);\n  });\n};\n\nPromise.race = function(promises){\n  var Class = this;\n\n  if (!isArray(promises))\n    throw new TypeError('You must pass an array to Promise.race().');\n\n  return new Class(function(resolve, reject) {\n    for (var i = 0, promise; i < promises.length; i++)\n    {\n      promise = promises[i];\n\n      if (promise && typeof promise.then === 'function')\n        promise.then(resolve, reject);\n      else\n        resolve(promise);\n    }\n  });\n};\n\nPromise.resolve = function(value){\n  var Class = this;\n\n  if (value && typeof value === 'object' && value.constructor === Class)\n    return value;\n\n  return new Class(function(resolve){\n    resolve(value);\n  });\n};\n\nPromise.reject = function(reason){\n  var Class = this;\n\n  return new Class(function(resolve, reject){\n    reject(reason);\n  });\n};\n\n})(typeof window != 'undefined' ? window : typeof global != 'undefined' ? global : typeof self != 'undefined' ? self : this);\n"]},"metadata":{},"sourceType":"script"}